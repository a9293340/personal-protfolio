<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>瀏覽器相容性測試 - POC-002</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a2e;
            color: white;
            padding: 20px;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .test-section {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
        }
        
        .test-result {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 5px;
            margin-left: 10px;
            font-weight: bold;
        }
        
        .support-yes {
            background: #4caf50;
            color: white;
        }
        
        .support-no {
            background: #f44336;
            color: white;
        }
        
        .support-partial {
            background: #ff9800;
            color: white;
        }
        
        .test-card {
            width: 200px;
            height: 120px;
            perspective: 1000px;
            margin: 20px auto;
        }
        
        .test-card-inner {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }
        
        .test-card:hover .test-card-inner {
            transform: rotateY(180deg);
        }
        
        .test-card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .test-card-front {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .test-card-back {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            transform: rotateY(180deg);
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>瀏覽器相容性測試報告</h1>
        <p>自動檢測當前瀏覽器對 CSS 3D Transform 和相關功能的支援程度</p>
        
        <div class="test-section">
            <h2>基本功能檢測</h2>
            <div id="basicTests">
                <!-- 動態生成測試結果 -->
            </div>
        </div>
        
        <div class="test-section">
            <h2>3D Transform 測試</h2>
            <p>請將滑鼠懸停在下方卡片上測試翻轉效果：</p>
            <div class="test-card">
                <div class="test-card-inner">
                    <div class="test-card-face test-card-front">
                        正面
                    </div>
                    <div class="test-card-face test-card-back">
                        背面
                    </div>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>效能檢測</h2>
            <div id="performanceTests">
                <!-- 動態生成效能測試結果 -->
            </div>
        </div>
        
        <div class="test-section">
            <h2>瀏覽器資訊</h2>
            <div id="browserInfo">
                <!-- 動態生成瀏覽器資訊 -->
            </div>
        </div>
    </div>

    <script>
        // 瀏覽器相容性測試
        function runCompatibilityTests() {
            const tests = [
                {
                    name: 'CSS 3D Transform',
                    test: () => {
                        const element = document.createElement('div');
                        element.style.transform = 'rotateY(90deg)';
                        return element.style.transform !== '';
                    }
                },
                {
                    name: 'Transform Style Preserve-3D',
                    test: () => {
                        const element = document.createElement('div');
                        element.style.transformStyle = 'preserve-3d';
                        return element.style.transformStyle === 'preserve-3d';
                    }
                },
                {
                    name: 'Backface Visibility',
                    test: () => {
                        const element = document.createElement('div');
                        element.style.backfaceVisibility = 'hidden';
                        return element.style.backfaceVisibility === 'hidden';
                    }
                },
                {
                    name: 'CSS Perspective',
                    test: () => {
                        const element = document.createElement('div');
                        element.style.perspective = '1000px';
                        return element.style.perspective === '1000px';
                    }
                },
                {
                    name: 'RequestAnimationFrame',
                    test: () => {
                        return 'requestAnimationFrame' in window;
                    }
                },
                {
                    name: 'Performance API',
                    test: () => {
                        return 'performance' in window && 'now' in performance;
                    }
                },
                {
                    name: 'Performance Memory',
                    test: () => {
                        return 'performance' in window && 'memory' in performance;
                    }
                },
                {
                    name: 'Touch Events',
                    test: () => {
                        return 'ontouchstart' in window;
                    }
                }
            ];
            
            const basicTestsContainer = document.getElementById('basicTests');
            
            tests.forEach(test => {
                const result = test.test();
                const resultElement = document.createElement('div');
                resultElement.innerHTML = `
                    ${test.name}: 
                    <span class="test-result ${result ? 'support-yes' : 'support-no'}">
                        ${result ? '支援' : '不支援'}
                    </span>
                `;
                basicTestsContainer.appendChild(resultElement);
            });
        }
        
        // 效能測試
        function runPerformanceTests() {
            const performanceContainer = document.getElementById('performanceTests');
            
            // FPS 測試
            let frameCount = 0;
            let lastTime = performance.now();
            let fps = 0;
            
            function measureFPS() {
                frameCount++;
                const currentTime = performance.now();
                
                if (currentTime - lastTime >= 1000) {
                    fps = frameCount;
                    frameCount = 0;
                    lastTime = currentTime;
                    
                    document.getElementById('fpsResult').textContent = fps;
                    
                    const fpsElement = document.getElementById('fpsResult');
                    if (fps >= 55) {
                        fpsElement.className = 'test-result support-yes';
                    } else if (fps >= 30) {
                        fpsElement.className = 'test-result support-partial';
                    } else {
                        fpsElement.className = 'test-result support-no';
                    }
                }
                
                requestAnimationFrame(measureFPS);
            }
            
            // 記憶體測試
            let memoryInfo = '不支援';
            let memoryClass = 'support-no';
            
            if ('memory' in performance) {
                const memory = performance.memory;
                const usedMB = Math.round(memory.usedJSHeapSize / 1024 / 1024);
                memoryInfo = `${usedMB} MB`;
                
                if (usedMB < 50) {
                    memoryClass = 'support-yes';
                } else if (usedMB < 100) {
                    memoryClass = 'support-partial';
                } else {
                    memoryClass = 'support-no';
                }
            }
            
            performanceContainer.innerHTML = `
                <div>當前 FPS: <span id="fpsResult" class="test-result">測量中...</span></div>
                <div>記憶體使用: <span class="test-result ${memoryClass}">${memoryInfo}</span></div>
            `;
            
            requestAnimationFrame(measureFPS);
        }
        
        // 瀏覽器資訊
        function displayBrowserInfo() {
            const browserContainer = document.getElementById('browserInfo');
            
            browserContainer.innerHTML = `
                <div><strong>User Agent:</strong> ${navigator.userAgent}</div>
                <div><strong>平台:</strong> ${navigator.platform}</div>
                <div><strong>語言:</strong> ${navigator.language}</div>
                <div><strong>視窗大小:</strong> ${window.innerWidth} x ${window.innerHeight}</div>
                <div><strong>螢幕解析度:</strong> ${screen.width} x ${screen.height}</div>
                <div><strong>設備像素比:</strong> ${window.devicePixelRatio}</div>
            `;
        }
        
        // 執行所有測試
        document.addEventListener('DOMContentLoaded', () => {
            runCompatibilityTests();
            runPerformanceTests();
            displayBrowserInfo();
        });
    </script>
</body>
</html>